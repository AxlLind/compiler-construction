Program(MainDecl(Identifier(Main),Identifier(App),List(),List(Println(Plus(StringLit(Final result: ),MethodCall(MethodCall(New(Identifier(NM)),Identifier(sqrt),List(IntLit(2))),Identifier(str),List()))))),List(ClassDecl(Identifier(Arr),None,List(),List(MethodDecl(false,Identifier(Arr),Identifier(ofDim),List(Formal(IntType(),Identifier(i))),List(),List(),If(Equals(IntLit(0),Identifier(i)),New(Identifier(Empty)),Some(MethodCall(New(Identifier(Cons)),Identifier(init),List(IntLit(0), MethodCall(This(),Identifier(ofDim),List(Minus(Identifier(i),IntLit(1))))))))), MethodDecl(false,UnitType(),Identifier(update),List(Formal(IntType(),Identifier(index)), Formal(IntType(),Identifier(newval))),List(),List(),Block(List())), MethodDecl(false,IntType(),Identifier(apply),List(Formal(IntType(),Identifier(index))),List(),List(),IntLit(0)), MethodDecl(false,IntType(),Identifier(size),List(),List(),List(),IntLit(0)))), ClassDecl(Identifier(Empty),Some(Identifier(Arr)),List(),List()), ClassDecl(Identifier(Cons),Some(Identifier(Arr)),List(VarDecl(IntType(),Identifier(value),IntLit(0)), VarDecl(Identifier(Arr),Identifier(next),New(Identifier(Empty)))),List(MethodDecl(false,Identifier(Cons),Identifier(init),List(Formal(IntType(),Identifier(x)), Formal(Identifier(Arr),Identifier(ne))),List(),List(Assign(Identifier(value),Identifier(x)), Assign(Identifier(next),Identifier(ne))),This()), MethodDecl(true,UnitType(),Identifier(update),List(Formal(IntType(),Identifier(index)), Formal(IntType(),Identifier(newval))),List(),List(),If(Equals(IntLit(0),Identifier(index)),Assign(Identifier(value),Identifier(newval)),Some(MethodCall(Identifier(next),Identifier(update),List(Minus(Identifier(index),IntLit(1)), Identifier(newval)))))), MethodDecl(true,IntType(),Identifier(apply),List(Formal(IntType(),Identifier(index))),List(),List(),If(Equals(IntLit(0),Identifier(index)),Identifier(value),Some(MethodCall(Identifier(next),Identifier(apply),List(Minus(Identifier(index),IntLit(1))))))), MethodDecl(true,IntType(),Identifier(size),List(),List(),List(),Plus(IntLit(1),MethodCall(Identifier(next),Identifier(size),List()))))), ClassDecl(Identifier(NM),None,List(),List(MethodDecl(false,Identifier(Real),Identifier(sqrt),List(Formal(IntType(),Identifier(n))),List(VarDecl(Identifier(Real),Identifier(guess),Null()), VarDecl(Identifier(Real),Identifier(orig),Null()), VarDecl(Identifier(Real),Identifier(result),Null())),List(Assign(Identifier(guess),MethodCall(New(Identifier(Real)),Identifier(init),List(IntLit(1), IntLit(4)))), Assign(Identifier(orig),MethodCall(New(Identifier(Real)),Identifier(init),List(Identifier(n), IntLit(4)))), Assign(Identifier(result),MethodCall(This(),Identifier(sqrtIter),List(Identifier(guess), IntLit(0), IntLit(5), Identifier(orig))))),Identifier(result)), MethodDecl(false,Identifier(Real),Identifier(sqrtIter),List(Formal(Identifier(Real),Identifier(guess)), Formal(IntType(),Identifier(i)), Formal(IntType(),Identifier(maxIter)), Formal(Identifier(Real),Identifier(original))),List(VarDecl(Identifier(Real),Identifier(average),Null()), VarDecl(Identifier(Real),Identifier(quotient),Null()), VarDecl(Identifier(Real),Identifier(result),Null())),List(If(Equals(Identifier(i),Identifier(maxIter)),Block(List(Assign(Identifier(result),Identifier(guess)))),Some(Block(List(Println(Plus(Plus(Plus(StringLit(Iteration ),Identifier(i)),StringLit(: Guess is )),MethodCall(Identifier(guess),Identifier(str),List()))), Assign(Identifier(quotient),MethodCall(Identifier(original),Identifier(divide),List(Identifier(guess)))), Assign(Identifier(average),MethodCall(MethodCall(Identifier(guess),Identifier(plus),List(Identifier(quotient))),Identifier(divide),List(MethodCall(New(Identifier(Real)),Identifier(init),List(IntLit(2), IntLit(4)))))), Assign(Identifier(result),MethodCall(This(),Identifier(sqrtIter),List(Identifier(average), Plus(Identifier(i),IntLit(1)), Identifier(maxIter), Identifier(original))))))))),Identifier(result)))), ClassDecl(Identifier(Real),None,List(VarDecl(IntType(),Identifier(integerPart),IntLit(0)), VarDecl(Identifier(Arr),Identifier(digits),Null()), VarDecl(Identifier(Util),Identifier(util),Null())),List(MethodDecl(false,Identifier(Real),Identifier(init),List(Formal(IntType(),Identifier(intPart)), Formal(IntType(),Identifier(digitsCount))),List(VarDecl(IntType(),Identifier(i),IntLit(0))),List(Assign(Identifier(util),New(Identifier(Util))), Assign(Identifier(integerPart),Identifier(intPart)), Assign(Identifier(digits),MethodCall(New(Identifier(Arr)),Identifier(ofDim),List(Identifier(digitsCount)))), Assign(Identifier(i),IntLit(0)), While(LessThan(Identifier(i),Identifier(digitsCount)),Block(List(MethodCall(Identifier(digits),Identifier(update),List(Identifier(i), IntLit(0))), Assign(Identifier(i),Plus(Identifier(i),IntLit(1))))))),This()), MethodDecl(false,Identifier(Arr),Identifier(getDigits),List(),List(),List(),Identifier(digits)), MethodDecl(false,IntType(),Identifier(getIntegerPart),List(),List(),List(),Identifier(integerPart)), MethodDecl(false,Identifier(Real),Identifier(setIntegerPart),List(Formal(IntType(),Identifier(p))),List(),List(Assign(Identifier(integerPart),Identifier(p))),This()), MethodDecl(false,Identifier(Real),Identifier(divide),List(Formal(Identifier(Real),Identifier(other))),List(VarDecl(IntType(),Identifier(i),IntLit(0)), VarDecl(IntType(),Identifier(int1),IntLit(0)), VarDecl(IntType(),Identifier(int2),IntLit(0)), VarDecl(IntType(),Identifier(len),IntLit(0)), VarDecl(Identifier(Arr),Identifier(otherDigits),Null()), VarDecl(Identifier(Frac),Identifier(f),Null()), VarDecl(Identifier(Real),Identifier(result),Null())),List(If(LessThan(MethodCall(Identifier(digits),Identifier(size),List()),MethodCall(MethodCall(Identifier(other),Identifier(getDigits),List()),Identifier(size),List())),Block(List(Assign(Identifier(len),MethodCall(Identifier(digits),Identifier(size),List())))),Some(Block(List(Assign(Identifier(len),MethodCall(MethodCall(Identifier(other),Identifier(getDigits),List()),Identifier(size),List())))))), Assign(Identifier(int1),MethodCall(This(),Identifier(getIntegerPart),List())), Assign(Identifier(int2),MethodCall(Identifier(other),Identifier(getIntegerPart),List())), Assign(Identifier(i),IntLit(0)), Assign(Identifier(otherDigits),MethodCall(Identifier(other),Identifier(getDigits),List())), While(LessThan(Identifier(i),Identifier(len)),Block(List(Assign(Identifier(int1),Plus(Times(Identifier(int1),IntLit(10)),MethodCall(Identifier(digits),Identifier(apply),List(Identifier(i))))), Assign(Identifier(int2),Plus(Times(Identifier(int2),IntLit(10)),MethodCall(Identifier(otherDigits),Identifier(apply),List(Identifier(i))))), Assign(Identifier(i),Plus(Identifier(i),IntLit(1)))))), Assign(Identifier(f),MethodCall(New(Identifier(Frac)),Identifier(init),List(Identifier(int1), Identifier(int2)))), Assign(Identifier(result),MethodCall(MethodCall(New(Identifier(Real)),Identifier(init),List(IntLit(3), IntLit(4))),Identifier(evalFrac),List(Identifier(f))))),Identifier(result)), MethodDecl(false,Identifier(Real),Identifier(evalFrac),List(Formal(Identifier(Frac),Identifier(frac))),List(VarDecl(IntType(),Identifier(leftover),IntLit(0)), VarDecl(IntType(),Identifier(i),IntLit(0)), VarDecl(IntType(),Identifier(den),IntLit(0))),List(Assign(Identifier(den),MethodCall(Identifier(frac),Identifier(getDenominator),List())), Assign(Identifier(integerPart),Div(MethodCall(Identifier(frac),Identifier(getNumerator),List()),Identifier(den))), If(Not(MethodCall(Identifier(frac),Identifier(isPos),List())),Block(List(Assign(Identifier(integerPart),Minus(IntLit(0),Identifier(integerPart))))),None), Assign(Identifier(leftover),MethodCall(Identifier(util),Identifier(mod),List(MethodCall(Identifier(frac),Identifier(getNumerator),List()), Identifier(den)))), Assign(Identifier(i),IntLit(0)), While(LessThan(Identifier(i),MethodCall(Identifier(digits),Identifier(size),List())),Block(List(Assign(Identifier(leftover),Times(IntLit(10),Identifier(leftover))), MethodCall(Identifier(digits),Identifier(update),List(Identifier(i), Div(Identifier(leftover),Identifier(den)))), Assign(Identifier(leftover),MethodCall(Identifier(util),Identifier(mod),List(Identifier(leftover), Identifier(den)))), Assign(Identifier(i),Plus(Identifier(i),IntLit(1))))))),This()), MethodDecl(false,Identifier(Real),Identifier(plus),List(Formal(Identifier(Real),Identifier(other))),List(VarDecl(IntType(),Identifier(len),IntLit(0)), VarDecl(Identifier(Arr),Identifier(od),Null()), VarDecl(Identifier(Arr),Identifier(resDig),Null()), VarDecl(IntType(),Identifier(carry),IntLit(0)), VarDecl(IntType(),Identifier(i),IntLit(0)), VarDecl(IntType(),Identifier(sum),IntLit(0)), VarDecl(Identifier(Real),Identifier(result),Null())),List(Assign(Identifier(od),MethodCall(Identifier(other),Identifier(getDigits),List())), If(LessThan(MethodCall(Identifier(digits),Identifier(size),List()),MethodCall(Identifier(od),Identifier(size),List())),Block(List(Assign(Identifier(len),MethodCall(Identifier(digits),Identifier(size),List())))),Some(Block(List(Assign(Identifier(len),MethodCall(Identifier(od),Identifier(size),List())))))), Assign(Identifier(result),MethodCall(New(Identifier(Real)),Identifier(init),List(IntLit(0), Identifier(len)))), Assign(Identifier(resDig),MethodCall(Identifier(result),Identifier(getDigits),List())), Assign(Identifier(carry),IntLit(0)), Assign(Identifier(i),Minus(Identifier(len),IntLit(1))), While(Not(LessThan(Identifier(i),IntLit(0))),Block(List(Assign(Identifier(sum),Plus(Plus(MethodCall(Identifier(digits),Identifier(apply),List(Identifier(i))),MethodCall(Identifier(od),Identifier(apply),List(Identifier(i)))),Identifier(carry))), Assign(Identifier(carry),Div(Identifier(sum),IntLit(10))), MethodCall(Identifier(resDig),Identifier(update),List(Identifier(i), MethodCall(Identifier(util),Identifier(mod),List(Identifier(sum), IntLit(10))))), Assign(Identifier(i),Minus(Identifier(i),IntLit(1))))))),MethodCall(Identifier(result),Identifier(setIntegerPart),List(Plus(Plus(Identifier(integerPart),MethodCall(Identifier(other),Identifier(getIntegerPart),List())),Identifier(carry))))), MethodDecl(false,StringType(),Identifier(str),List(),List(VarDecl(StringType(),Identifier(ret),Null()), VarDecl(IntType(),Identifier(i),IntLit(0))),List(Assign(Identifier(ret),Plus(Plus(StringLit(),Identifier(integerPart)),StringLit(.))), Assign(Identifier(i),IntLit(0)), While(LessThan(Identifier(i),MethodCall(Identifier(digits),Identifier(size),List())),Block(List(Assign(Identifier(ret),Plus(Identifier(ret),MethodCall(Identifier(digits),Identifier(apply),List(Identifier(i))))), Assign(Identifier(i),Plus(Identifier(i),IntLit(1))))))),Identifier(ret)))), ClassDecl(Identifier(Frac),None,List(VarDecl(IntType(),Identifier(numerator),IntLit(0)), VarDecl(IntType(),Identifier(denominator),IntLit(0)), VarDecl(BooleanType(),Identifier(sign),False()), VarDecl(Identifier(Util),Identifier(util),Null())),List(MethodDecl(false,Identifier(Frac),Identifier(init),List(Formal(IntType(),Identifier(n)), Formal(IntType(),Identifier(d))),List(),List(Assign(Identifier(util),New(Identifier(Util))), Assign(Identifier(numerator),MethodCall(Identifier(util),Identifier(abs),List(Identifier(n)))), Assign(Identifier(denominator),MethodCall(Identifier(util),Identifier(abs),List(Identifier(d)))), Assign(Identifier(sign),Or(And(LessThan(Identifier(n),IntLit(0)),LessThan(Identifier(d),IntLit(0))),And(Or(LessThan(IntLit(0),Identifier(n)),Equals(Identifier(n),IntLit(0))),Or(LessThan(IntLit(0),Identifier(d)),Equals(Identifier(d),IntLit(0))))))),MethodCall(This(),Identifier(simplify),List())), MethodDecl(false,IntType(),Identifier(getNumerator),List(),List(),List(),Identifier(numerator)), MethodDecl(false,IntType(),Identifier(getDenominator),List(),List(),List(),Identifier(denominator)), MethodDecl(false,Identifier(Frac),Identifier(setPos),List(Formal(BooleanType(),Identifier(positive))),List(),List(Assign(Identifier(sign),Identifier(positive))),This()), MethodDecl(false,BooleanType(),Identifier(isPos),List(),List(),List(),Identifier(sign)), MethodDecl(false,Identifier(Frac),Identifier(simplify),List(),List(VarDecl(IntType(),Identifier(gcd_),IntLit(0))),List(If(And(Not(Equals(Identifier(numerator),IntLit(0))),Not(Equals(Identifier(denominator),IntLit(0)))),Block(List(Assign(Identifier(gcd_),MethodCall(Identifier(util),Identifier(gcd),List(Identifier(numerator), Identifier(denominator)))), If(Not(Equals(Identifier(gcd_),IntLit(1))),Block(List(Assign(Identifier(numerator),Div(Identifier(numerator),Identifier(gcd_))), Assign(Identifier(denominator),Div(Identifier(denominator),Identifier(gcd_))))),None))),None)),This()), MethodDecl(false,Identifier(Frac),Identifier(plus),List(Formal(Identifier(Frac),Identifier(other))),List(VarDecl(IntType(),Identifier(lcm),IntLit(0)), VarDecl(IntType(),Identifier(lfac),IntLit(0)), VarDecl(IntType(),Identifier(rfac),IntLit(0))),List(Assign(Identifier(lcm),MethodCall(Identifier(util),Identifier(lcm),List(Identifier(denominator), MethodCall(Identifier(other),Identifier(getDenominator),List())))), Assign(Identifier(lfac),Div(Identifier(lcm),Identifier(denominator))), If(Not(Identifier(sign)),Block(List(Assign(Identifier(lfac),Minus(IntLit(0),Identifier(lfac))))),None), Assign(Identifier(rfac),Div(Identifier(lcm),MethodCall(Identifier(other),Identifier(getDenominator),List()))), If(Not(MethodCall(Identifier(other),Identifier(isPos),List())),Block(List(Assign(Identifier(rfac),Minus(IntLit(0),Identifier(rfac))))),None)),MethodCall(New(Identifier(Frac)),Identifier(init),List(Plus(Times(Identifier(lfac),Identifier(numerator)),Times(Identifier(rfac),MethodCall(Identifier(other),Identifier(getNumerator),List()))), Identifier(lcm)))), MethodDecl(false,Identifier(Frac),Identifier(minus),List(Formal(Identifier(Frac),Identifier(other))),List(),List(),MethodCall(This(),Identifier(plus),List(MethodCall(Identifier(other),Identifier(negative),List())))), MethodDecl(false,Identifier(Frac),Identifier(times),List(Formal(Identifier(Frac),Identifier(other))),List(),List(),MethodCall(MethodCall(MethodCall(New(Identifier(Frac)),Identifier(init),List(Times(Identifier(numerator),MethodCall(Identifier(other),Identifier(getNumerator),List())), Times(Identifier(denominator),MethodCall(Identifier(other),Identifier(getDenominator),List())))),Identifier(simplify),List()),Identifier(setPos),List(Or(And(MethodCall(This(),Identifier(isPos),List()),MethodCall(Identifier(other),Identifier(isPos),List())),And(Not(MethodCall(This(),Identifier(isPos),List())),Not(MethodCall(Identifier(other),Identifier(isPos),List()))))))), MethodDecl(false,Identifier(Frac),Identifier(divided),List(Formal(Identifier(Frac),Identifier(other))),List(),List(),MethodCall(This(),Identifier(times),List(MethodCall(Identifier(other),Identifier(inverse),List())))), MethodDecl(false,Identifier(Frac),Identifier(inverse),List(),List(),List(),MethodCall(New(Identifier(Frac)),Identifier(init),List(Identifier(denominator), Identifier(numerator)))), MethodDecl(false,Identifier(Frac),Identifier(negative),List(),List(),List(),MethodCall(MethodCall(New(Identifier(Frac)),Identifier(init),List(Identifier(numerator), Identifier(denominator))),Identifier(setPos),List(False()))), MethodDecl(false,StringType(),Identifier(str),List(),List(VarDecl(StringType(),Identifier(result),Null())),List(If(Identifier(sign),Block(List(Assign(Identifier(result),StringLit()))),Some(Block(List(Assign(Identifier(result),StringLit(-))))))),Plus(Plus(Plus(Identifier(result),Identifier(numerator)),StringLit(/)),Identifier(denominator))))), ClassDecl(Identifier(Util),None,List(),List(MethodDecl(false,IntType(),Identifier(abs),List(Formal(IntType(),Identifier(v))),List(VarDecl(IntType(),Identifier(res),IntLit(0))),List(If(Not(LessThan(Identifier(v),IntLit(0))),Block(List(Assign(Identifier(res),Identifier(v)))),Some(Block(List(Assign(Identifier(res),Minus(IntLit(0),Identifier(v)))))))),Identifier(res)), MethodDecl(false,IntType(),Identifier(gcd),List(Formal(IntType(),Identifier(m_)), Formal(IntType(),Identifier(n_))),List(VarDecl(IntType(),Identifier(t),IntLit(0)), VarDecl(IntType(),Identifier(r),IntLit(0)), VarDecl(IntType(),Identifier(result),IntLit(0)), VarDecl(IntType(),Identifier(m),IntLit(0)), VarDecl(IntType(),Identifier(n),IntLit(0))),List(Assign(Identifier(m),MethodCall(This(),Identifier(abs),List(Identifier(m_)))), Assign(Identifier(n),MethodCall(This(),Identifier(abs),List(Identifier(n_)))), If(LessThan(Identifier(m),Identifier(n)),Block(List(Assign(Identifier(t),Identifier(m)), Assign(Identifier(m),Identifier(n)), Assign(Identifier(n),Identifier(t)))),None), Assign(Identifier(r),MethodCall(This(),Identifier(mod),List(Identifier(m), Identifier(n)))), If(Equals(Identifier(r),IntLit(0)),Block(List(Assign(Identifier(result),Identifier(n)))),Some(Block(List(Assign(Identifier(result),MethodCall(This(),Identifier(gcd),List(Identifier(n), Identifier(r))))))))),Identifier(result)), MethodDecl(false,IntType(),Identifier(lcm),List(Formal(IntType(),Identifier(m)), Formal(IntType(),Identifier(n))),List(),List(),Div(Times(Identifier(n),Identifier(m)),MethodCall(This(),Identifier(gcd),List(Identifier(n), Identifier(m))))), MethodDecl(false,IntType(),Identifier(mod),List(Formal(IntType(),Identifier(m)), Formal(IntType(),Identifier(n))),List(),List(),Minus(Identifier(m),Times(Identifier(n),Div(Identifier(m),Identifier(n)))))))))

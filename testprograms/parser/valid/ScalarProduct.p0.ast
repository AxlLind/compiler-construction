Program(MainDecl(Identifier(Main),Identifier(App),List(),List(If(MethodCall(New(Identifier(Sim)),Identifier(start),List()),Block(List(Println(StringLit(Ok)))),Some(Block(List(Println(StringLit(error)))))))),List(ClassDecl(Identifier(Arr),None,List(),List(MethodDecl(false,Identifier(Arr),Identifier(ofDim),List(Formal(IntType(),Identifier(i))),List(),List(),If(Equals(IntLit(0),Identifier(i)),New(Identifier(Empty)),Some(MethodCall(New(Identifier(Cons)),Identifier(init),List(IntLit(0), MethodCall(This(),Identifier(ofDim),List(Minus(Identifier(i),IntLit(1))))))))), MethodDecl(false,UnitType(),Identifier(update),List(Formal(IntType(),Identifier(index)), Formal(IntType(),Identifier(newval))),List(),List(),Block(List())), MethodDecl(false,IntType(),Identifier(apply),List(Formal(IntType(),Identifier(index))),List(),List(),IntLit(0)), MethodDecl(false,IntType(),Identifier(size),List(),List(),List(),IntLit(0)))), ClassDecl(Identifier(Empty),Some(Identifier(Arr)),List(),List()), ClassDecl(Identifier(Cons),Some(Identifier(Arr)),List(VarDecl(IntType(),Identifier(value),IntLit(0)), VarDecl(Identifier(Arr),Identifier(next),New(Identifier(Empty)))),List(MethodDecl(false,Identifier(Cons),Identifier(init),List(Formal(IntType(),Identifier(x)), Formal(Identifier(Arr),Identifier(ne))),List(),List(Assign(Identifier(value),Identifier(x)), Assign(Identifier(next),Identifier(ne))),This()), MethodDecl(true,UnitType(),Identifier(update),List(Formal(IntType(),Identifier(index)), Formal(IntType(),Identifier(newval))),List(),List(),If(Equals(IntLit(0),Identifier(index)),Assign(Identifier(value),Identifier(newval)),Some(MethodCall(Identifier(next),Identifier(update),List(Minus(Identifier(index),IntLit(1)), Identifier(newval)))))), MethodDecl(true,IntType(),Identifier(apply),List(Formal(IntType(),Identifier(index))),List(),List(),If(Equals(IntLit(0),Identifier(index)),Identifier(value),Some(MethodCall(Identifier(next),Identifier(apply),List(Minus(Identifier(index),IntLit(1))))))), MethodDecl(true,IntType(),Identifier(size),List(),List(),List(),Plus(IntLit(1),MethodCall(Identifier(next),Identifier(size),List()))))), ClassDecl(Identifier(Sim),None,List(VarDecl(Identifier(Vector4),Identifier(v1),Null()), VarDecl(Identifier(Vector4),Identifier(v2),Null()), VarDecl(Identifier(Vector4),Identifier(v3),Null())),List(MethodDecl(false,BooleanType(),Identifier(start),List(),List(),List(Assign(Identifier(v1),New(Identifier(Vector4))), Assign(Identifier(v2),New(Identifier(Vector4))), Assign(Identifier(v3),New(Identifier(Vector4))), Println(MethodCall(Identifier(v1),Identifier(initialize),List(StringLit(v1), IntLit(5), IntLit(3), IntLit(0), IntLit(1)))), Println(MethodCall(Identifier(v2),Identifier(initialize),List(StringLit(v2), IntLit(0), IntLit(3), IntLit(4), IntLit(7)))), Println(MethodCall(Identifier(v3),Identifier(initialize),List(StringLit(v3), IntLit(2), IntLit(1), IntLit(9), IntLit(5)))), Println(Plus(Plus(Plus(Plus(Plus(StringLit(Scalar product ),MethodCall(Identifier(v1),Identifier(getName),List())),StringLit(.)),MethodCall(Identifier(v2),Identifier(getName),List())),StringLit(: )),MethodCall(Identifier(v1),Identifier(scalar),List(Identifier(v2))))), Println(Plus(Plus(Plus(Plus(Plus(StringLit(Scalar product ),MethodCall(Identifier(v1),Identifier(getName),List())),StringLit(.)),MethodCall(Identifier(v3),Identifier(getName),List())),StringLit(: )),MethodCall(Identifier(v1),Identifier(scalar),List(Identifier(v3))))), Println(Plus(Plus(Plus(Plus(Plus(StringLit(Scalar product ),MethodCall(Identifier(v2),Identifier(getName),List())),StringLit(.)),MethodCall(Identifier(v3),Identifier(getName),List())),StringLit(: )),MethodCall(Identifier(v2),Identifier(scalar),List(Identifier(v3)))))),True()))), ClassDecl(Identifier(Vector4),None,List(VarDecl(Identifier(Arr),Identifier(vect),Null()), VarDecl(StringType(),Identifier(varName),Null())),List(MethodDecl(false,StringType(),Identifier(initialize),List(Formal(StringType(),Identifier(name)), Formal(IntType(),Identifier(n1)), Formal(IntType(),Identifier(n2)), Formal(IntType(),Identifier(n3)), Formal(IntType(),Identifier(n4))),List(),List(Assign(Identifier(vect),MethodCall(New(Identifier(Arr)),Identifier(ofDim),List(IntLit(4)))), Assign(Identifier(varName),Identifier(name)), MethodCall(Identifier(vect),Identifier(update),List(IntLit(0), Identifier(n1))), MethodCall(Identifier(vect),Identifier(update),List(IntLit(1), Identifier(n2))), MethodCall(Identifier(vect),Identifier(update),List(IntLit(2), Identifier(n3))), MethodCall(Identifier(vect),Identifier(update),List(IntLit(3), Identifier(n4)))),Plus(Plus(Plus(Plus(Plus(Plus(Plus(Plus(Plus(Plus(StringLit(New vector ),Identifier(varName)),StringLit( created: [)),MethodCall(Identifier(vect),Identifier(apply),List(IntLit(0)))),StringLit(,)),MethodCall(Identifier(vect),Identifier(apply),List(IntLit(1)))),StringLit(,)),MethodCall(Identifier(vect),Identifier(apply),List(IntLit(2)))),StringLit(,)),MethodCall(Identifier(vect),Identifier(apply),List(IntLit(3)))),StringLit(]))), MethodDecl(false,IntType(),Identifier(scalar),List(Formal(Identifier(Vector4),Identifier(v))),List(VarDecl(IntType(),Identifier(x),IntLit(0))),List(Assign(Identifier(x),Plus(Plus(Plus(Times(MethodCall(Identifier(vect),Identifier(apply),List(IntLit(0))),MethodCall(Identifier(v),Identifier(getInd),List(IntLit(0)))),Times(MethodCall(Identifier(vect),Identifier(apply),List(IntLit(1))),MethodCall(Identifier(v),Identifier(getInd),List(IntLit(1))))),Times(MethodCall(Identifier(vect),Identifier(apply),List(IntLit(2))),MethodCall(Identifier(v),Identifier(getInd),List(IntLit(2))))),Times(MethodCall(Identifier(vect),Identifier(apply),List(IntLit(3))),MethodCall(Identifier(v),Identifier(getInd),List(IntLit(3))))))),Identifier(x)), MethodDecl(false,StringType(),Identifier(getName),List(),List(),List(),Identifier(varName)), MethodDecl(false,IntType(),Identifier(getInd),List(Formal(IntType(),Identifier(i))),List(),List(),MethodCall(Identifier(vect),Identifier(apply),List(Identifier(i))))))))

Program(MainDecl(Identifier(Main),Identifier(App),List(),List(Println(Plus(StringLit(Polymorphism and Reference test suite ),MethodCall(New(Identifier(PolymorphismTest)),Identifier(run),List()))))),List(ClassDecl(Identifier(Arr),None,List(),List(MethodDecl(false,Identifier(Arr),Identifier(ofDim),List(Formal(IntType(),Identifier(i))),List(),List(),If(Equals(IntLit(0),Identifier(i)),New(Identifier(Empty)),Some(MethodCall(New(Identifier(Cons)),Identifier(init),List(IntLit(0), MethodCall(This(),Identifier(ofDim),List(Minus(Identifier(i),IntLit(1))))))))), MethodDecl(false,UnitType(),Identifier(update),List(Formal(IntType(),Identifier(index)), Formal(IntType(),Identifier(newval))),List(),List(),Block(List())), MethodDecl(false,IntType(),Identifier(apply),List(Formal(IntType(),Identifier(index))),List(),List(),IntLit(0)), MethodDecl(false,IntType(),Identifier(size),List(),List(),List(),IntLit(0)))), ClassDecl(Identifier(Empty),Some(Identifier(Arr)),List(),List()), ClassDecl(Identifier(Cons),Some(Identifier(Arr)),List(VarDecl(IntType(),Identifier(value),IntLit(0)), VarDecl(Identifier(Arr),Identifier(next),New(Identifier(Empty)))),List(MethodDecl(false,Identifier(Cons),Identifier(init),List(Formal(IntType(),Identifier(x)), Formal(Identifier(Arr),Identifier(ne))),List(),List(Assign(Identifier(value),Identifier(x)), Assign(Identifier(next),Identifier(ne))),This()), MethodDecl(true,UnitType(),Identifier(update),List(Formal(IntType(),Identifier(index)), Formal(IntType(),Identifier(newval))),List(),List(),If(Equals(IntLit(0),Identifier(index)),Assign(Identifier(value),Identifier(newval)),Some(MethodCall(Identifier(next),Identifier(update),List(Minus(Identifier(index),IntLit(1)), Identifier(newval)))))), MethodDecl(true,IntType(),Identifier(apply),List(Formal(IntType(),Identifier(index))),List(),List(),If(Equals(IntLit(0),Identifier(index)),Identifier(value),Some(MethodCall(Identifier(next),Identifier(apply),List(Minus(Identifier(index),IntLit(1))))))), MethodDecl(true,IntType(),Identifier(size),List(),List(),List(),Plus(IntLit(1),MethodCall(Identifier(next),Identifier(size),List()))))), ClassDecl(Identifier(PolymorphismTest),None,List(),List(MethodDecl(false,StringType(),Identifier(run),List(),List(VarDecl(Identifier(Shape),Identifier(shape),Null()), VarDecl(IntType(),Identifier(unit),IntLit(0))),List(Assign(Identifier(shape),MethodCall(New(Identifier(Shape)),Identifier(init),List(StringLit(blue)))), Assign(Identifier(unit),MethodCall(This(),Identifier(displayShape),List(Identifier(shape)))), Assign(Identifier(shape),MethodCall(New(Identifier(Rectangle)),Identifier(initRectangle),List(StringLit(red), IntLit(2), IntLit(4)))), Assign(Identifier(unit),MethodCall(This(),Identifier(displayShape),List(Identifier(shape)))), Assign(Identifier(shape),MethodCall(New(Identifier(Square)),Identifier(initSquare),List(StringLit(yellow), IntLit(2)))), Assign(Identifier(unit),MethodCall(This(),Identifier(displayShape),List(Identifier(shape)))), Assign(Identifier(shape),MethodCall(New(Identifier(Circle)),Identifier(init),List(StringLit(green)))), Assign(Identifier(unit),MethodCall(This(),Identifier(displayShape),List(Identifier(shape)))), Println(StringLit(---------------------)), Assign(Identifier(unit),MethodCall(MethodCall(New(Identifier(Circle)),Identifier(initCircle),List(StringLit())),Identifier(drawTwice),List())), Println(StringLit(---------------------)), Assign(Identifier(unit),MethodCall(New(Identifier(ReferenceTest)),Identifier(run),List()))),StringLit(done)), MethodDecl(false,IntType(),Identifier(displayShape),List(Formal(Identifier(Shape),Identifier(shape))),List(VarDecl(StringType(),Identifier(text),Null())),List(Assign(Identifier(text),Plus(StringLit(I am a ),MethodCall(Identifier(shape),Identifier(getColor),List()))), Assign(Identifier(text),Plus(Identifier(text),StringLit( ))), Assign(Identifier(text),Plus(Identifier(text),MethodCall(Identifier(shape),Identifier(getName),List()))), Println(Identifier(text))),MethodCall(Identifier(shape),Identifier(draw),List())))), ClassDecl(Identifier(ReferenceTest),None,List(),List(MethodDecl(false,IntType(),Identifier(run),List(),List(VarDecl(IntType(),Identifier(unit),IntLit(0)), VarDecl(BooleanType(),Identifier(bool1),False()), VarDecl(BooleanType(),Identifier(bool2),False()), VarDecl(IntType(),Identifier(int1),IntLit(0)), VarDecl(IntType(),Identifier(int2),IntLit(0)), VarDecl(Identifier(Arr),Identifier(intArr1),Null()), VarDecl(Identifier(Arr),Identifier(intArr2),Null()), VarDecl(StringType(),Identifier(string1),Null()), VarDecl(StringType(),Identifier(string2),Null()), VarDecl(Identifier(Shape),Identifier(shape1),Null()), VarDecl(Identifier(Shape),Identifier(shape2),Null())),List(Assign(Identifier(bool1),True()), Assign(Identifier(bool2),False()), Assign(Identifier(unit),MethodCall(This(),Identifier(swapBoolean),List(Identifier(bool1), Identifier(bool2)))), If(Identifier(bool1),Println(StringLit(bool1: true)),Some(Println(StringLit(bool1: false)))), If(Identifier(bool2),Println(StringLit(bool2: true)),Some(Println(StringLit(bool2: false)))), Assign(Identifier(int1),IntLit(1)), Assign(Identifier(int2),IntLit(2)), Assign(Identifier(unit),MethodCall(This(),Identifier(swapInt),List(Identifier(int1), Identifier(int2)))), Println(Plus(StringLit(int1: ),Identifier(int1))), Println(Plus(StringLit(int2: ),Identifier(int2))), Assign(Identifier(intArr1),MethodCall(New(Identifier(Arr)),Identifier(ofDim),List(IntLit(1)))), Assign(Identifier(intArr2),MethodCall(New(Identifier(Arr)),Identifier(ofDim),List(IntLit(2)))), Assign(Identifier(unit),MethodCall(This(),Identifier(swapIntArr),List(Identifier(intArr1), Identifier(intArr2)))), Println(Plus(StringLit(intArr1: ),MethodCall(Identifier(intArr1),Identifier(size),List()))), Println(Plus(StringLit(intArr2: ),MethodCall(Identifier(intArr2),Identifier(size),List()))), MethodCall(Identifier(intArr1),Identifier(update),List(IntLit(0), IntLit(1))), MethodCall(Identifier(intArr2),Identifier(update),List(IntLit(0), IntLit(2))), Assign(Identifier(unit),MethodCall(This(),Identifier(swapIntArrValue),List(Identifier(intArr1), Identifier(intArr2)))), Println(Plus(StringLit(intArr1val: ),MethodCall(Identifier(intArr1),Identifier(apply),List(IntLit(0))))), Println(Plus(StringLit(intArr2val: ),MethodCall(Identifier(intArr2),Identifier(apply),List(IntLit(0))))), Assign(Identifier(string1),StringLit(1)), Assign(Identifier(string2),StringLit(2)), Assign(Identifier(unit),MethodCall(This(),Identifier(swapString),List(Identifier(string1), Identifier(string2)))), Println(Plus(StringLit(string1: ),Identifier(string1))), Println(Plus(StringLit(string2: ),Identifier(string2))), Assign(Identifier(unit),MethodCall(This(),Identifier(concatStringValue),List(Identifier(string1), Identifier(string2)))), Println(Plus(StringLit(string1val: ),Identifier(string1))), Println(Plus(StringLit(string2val: ),Identifier(string2))), Assign(Identifier(shape1),MethodCall(New(Identifier(Shape)),Identifier(init),List(StringLit(1)))), Assign(Identifier(shape2),MethodCall(New(Identifier(Shape)),Identifier(init),List(StringLit(2)))), Assign(Identifier(unit),MethodCall(This(),Identifier(swapShape),List(Identifier(shape1), Identifier(shape2)))), Println(Plus(StringLit(shape1: ),MethodCall(Identifier(shape1),Identifier(getColor),List()))), Println(Plus(StringLit(shape2: ),MethodCall(Identifier(shape2),Identifier(getColor),List()))), Assign(Identifier(unit),MethodCall(This(),Identifier(resetShape),List(Identifier(shape1), Identifier(shape2)))), Println(Plus(StringLit(shape1new: ),MethodCall(Identifier(shape1),Identifier(getColor),List()))), Println(Plus(StringLit(shape2set: ),MethodCall(Identifier(shape2),Identifier(getColor),List())))),IntLit(0)), MethodDecl(false,IntType(),Identifier(swapBoolean),List(Formal(BooleanType(),Identifier(n1In)), Formal(BooleanType(),Identifier(n2In))),List(VarDecl(BooleanType(),Identifier(n1),Identifier(n1In)), VarDecl(BooleanType(),Identifier(n2),Identifier(n2In)), VarDecl(BooleanType(),Identifier(temp),False())),List(Assign(Identifier(temp),Identifier(n1)), Assign(Identifier(n1),Identifier(n2)), Assign(Identifier(n2),Identifier(temp))),IntLit(0)), MethodDecl(false,IntType(),Identifier(swapInt),List(Formal(IntType(),Identifier(n1In)), Formal(IntType(),Identifier(n2In))),List(VarDecl(IntType(),Identifier(n1),Identifier(n1In)), VarDecl(IntType(),Identifier(n2),Identifier(n2In)), VarDecl(IntType(),Identifier(temp),IntLit(0))),List(Assign(Identifier(temp),Identifier(n1)), Assign(Identifier(n1),Identifier(n2)), Assign(Identifier(n2),Identifier(temp))),IntLit(0)), MethodDecl(false,IntType(),Identifier(swapIntArr),List(Formal(Identifier(Arr),Identifier(n1In)), Formal(Identifier(Arr),Identifier(n2In))),List(VarDecl(Identifier(Arr),Identifier(n1),Identifier(n1In)), VarDecl(Identifier(Arr),Identifier(n2),Identifier(n2In)), VarDecl(Identifier(Arr),Identifier(temp),Null())),List(Assign(Identifier(temp),Identifier(n1)), Assign(Identifier(n1),Identifier(n2)), Assign(Identifier(n2),Identifier(temp))),IntLit(0)), MethodDecl(false,IntType(),Identifier(swapIntArrValue),List(Formal(Identifier(Arr),Identifier(n1)), Formal(Identifier(Arr),Identifier(n2))),List(VarDecl(IntType(),Identifier(temp),IntLit(0))),List(Assign(Identifier(temp),MethodCall(Identifier(n1),Identifier(apply),List(IntLit(0)))), MethodCall(Identifier(n1),Identifier(update),List(IntLit(0), MethodCall(Identifier(n2),Identifier(apply),List(IntLit(0))))), MethodCall(Identifier(n2),Identifier(update),List(IntLit(0), Identifier(temp)))),IntLit(0)), MethodDecl(false,IntType(),Identifier(swapString),List(Formal(StringType(),Identifier(n1In)), Formal(StringType(),Identifier(n2In))),List(VarDecl(StringType(),Identifier(n1),Identifier(n1In)), VarDecl(StringType(),Identifier(n2),Identifier(n2In)), VarDecl(StringType(),Identifier(temp),Null())),List(Assign(Identifier(temp),Identifier(n1)), Assign(Identifier(n1),Identifier(n2)), Assign(Identifier(n2),Identifier(temp))),IntLit(0)), MethodDecl(false,IntType(),Identifier(concatStringValue),List(Formal(StringType(),Identifier(n1)), Formal(StringType(),Identifier(n2))),List(VarDecl(StringType(),Identifier(n1tmp),Plus(Identifier(n1),Identifier(n2)))),List(),IntLit(0)), MethodDecl(false,IntType(),Identifier(swapShape),List(Formal(Identifier(Shape),Identifier(n1In)), Formal(Identifier(Shape),Identifier(n2In))),List(VarDecl(Identifier(Shape),Identifier(n1),Identifier(n1In)), VarDecl(Identifier(Shape),Identifier(n2),Identifier(n2In)), VarDecl(Identifier(Shape),Identifier(temp),Null())),List(Assign(Identifier(temp),Identifier(n1)), Assign(Identifier(n1),Identifier(n2)), Assign(Identifier(n2),Identifier(temp))),IntLit(0)), MethodDecl(false,IntType(),Identifier(resetShape),List(Formal(Identifier(Shape),Identifier(n1In)), Formal(Identifier(Shape),Identifier(n2))),List(VarDecl(IntType(),Identifier(unit),IntLit(0)), VarDecl(Identifier(Shape),Identifier(n1),MethodCall(New(Identifier(Shape)),Identifier(init),List(StringLit(3))))),List(Assign(Identifier(unit),MethodCall(Identifier(n2),Identifier(setColor),List(StringLit(3))))),IntLit(0)))), ClassDecl(Identifier(Shape),None,List(VarDecl(StringType(),Identifier(color),Null())),List(MethodDecl(false,Identifier(Shape),Identifier(init),List(Formal(StringType(),Identifier(col))),List(),List(Assign(Identifier(color),Identifier(col))),This()), MethodDecl(false,StringType(),Identifier(getName),List(),List(),List(),StringLit(shape)), MethodDecl(false,IntType(),Identifier(draw),List(),List(),List(Println(StringLit(~))),IntLit(0)), MethodDecl(false,StringType(),Identifier(getColor),List(),List(),List(),Identifier(color)), MethodDecl(false,IntType(),Identifier(setColor),List(Formal(StringType(),Identifier(col))),List(),List(Assign(Identifier(color),Identifier(col))),IntLit(0)))), ClassDecl(Identifier(Rectangle),Some(Identifier(Shape)),List(VarDecl(IntType(),Identifier(x),IntLit(0)), VarDecl(IntType(),Identifier(y),IntLit(0))),List(MethodDecl(false,Identifier(Rectangle),Identifier(initRectangle),List(Formal(StringType(),Identifier(c)), Formal(IntType(),Identifier(a)), Formal(IntType(),Identifier(b))),List(VarDecl(Identifier(Shape),Identifier(unit),Null())),List(Assign(Identifier(x),Identifier(a)), Assign(Identifier(y),Identifier(b)), Assign(Identifier(unit),MethodCall(This(),Identifier(init),List(Identifier(c))))),This()), MethodDecl(true,StringType(),Identifier(getName),List(),List(),List(),StringLit(rectangle)), MethodDecl(true,IntType(),Identifier(draw),List(),List(VarDecl(StringType(),Identifier(first),Null()), VarDecl(StringType(),Identifier(second),Null()), VarDecl(IntType(),Identifier(i),IntLit(0))),List(Assign(Identifier(i),IntLit(0)), Assign(Identifier(first),StringLit( )), Assign(Identifier(second),StringLit(|)), While(LessThan(Identifier(i),Identifier(x)),Block(List(Assign(Identifier(first),Plus(Identifier(first),StringLit(-))), Assign(Identifier(second),Plus(Identifier(second),StringLit( ))), Assign(Identifier(i),Plus(Identifier(i),IntLit(1)))))), Assign(Identifier(second),Plus(Identifier(second),StringLit(|))), Println(Identifier(first)), Assign(Identifier(i),IntLit(0)), While(LessThan(Identifier(i),Identifier(y)),Block(List(Println(Identifier(second)), Assign(Identifier(i),Plus(Identifier(i),IntLit(1)))))), Println(Identifier(first))),IntLit(0)))), ClassDecl(Identifier(Square),Some(Identifier(Rectangle)),List(),List(MethodDecl(false,Identifier(Square),Identifier(initSquare),List(Formal(StringType(),Identifier(c)), Formal(IntType(),Identifier(side))),List(VarDecl(Identifier(Shape),Identifier(unit),Null())),List(Assign(Identifier(unit),MethodCall(This(),Identifier(initRectangle),List(Identifier(c), Identifier(side), Identifier(side))))),This()), MethodDecl(true,StringType(),Identifier(getName),List(),List(),List(),StringLit(square)))), ClassDecl(Identifier(Circle),Some(Identifier(Shape)),List(),List(MethodDecl(false,Identifier(Circle),Identifier(initCircle),List(Formal(StringType(),Identifier(c))),List(VarDecl(Identifier(Shape),Identifier(unit),Null())),List(Assign(Identifier(unit),MethodCall(This(),Identifier(init),List(Identifier(c))))),This()), MethodDecl(true,StringType(),Identifier(getName),List(),List(),List(),StringLit(circle)), MethodDecl(true,IntType(),Identifier(draw),List(),List(),List(Println(StringLit(O))),IntLit(0)), MethodDecl(false,IntType(),Identifier(drawTwice),List(),List(),List(),Plus(MethodCall(This(),Identifier(draw),List()),MethodCall(This(),Identifier(draw),List())))))))
